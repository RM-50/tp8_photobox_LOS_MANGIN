"use strict";(()=>{var h="https://webetu.iutnc.univ-lorraine.fr/www/canals5/phox/api",a="https://webetu.iutnc.univ-lorraine.fr";function f(t){return fetch(`${h}/photos/${t}`,{credentials:"include"}).then(e=>e.json()).catch(e=>console.log(e))}function l(t){return fetch(a+t,{credentials:"include"}).then(e=>e.json()).catch(e=>console.log(e))}var g,y,x,E,C;async function s(t){return await l(t).then(e=>{g=e.photos,y=e.links.next.href,x=e.links.prev.href,E=e.links.first.href,C=e.links.last.href}),g}function _(){return s(y)}function b(){return s(x)}function v(){return s(E)}function I(){return s(C)}function B(t){let o=document.getElementById("gallery"),e=document.getElementById("gallery_container"),n=document.createElement("div");n.setAttribute("id","gallery_container"),n.classList.add("gallery-container"),t.forEach(r=>{let c=document.createElement("div"),i=document.createElement("img");c.classList.add("vignette"),i.setAttribute("data-photoId",r.photo.id),i.setAttribute("src",a+r.photo.thumbnail.href),c.appendChild(i),n.appendChild(c)}),o.replaceChild(n,e)}function k(t){let o=document.getElementById("gallery"),e=document.getElementById("la_photo"),n=document.createElement("section"),r=document.createElement("ul");r.setAttribute("id","les_commentaires");let c=document.createElement("h4");c.setAttribute("id","la_categorie");let i=document.createElement("img"),p=document.createElement("h4"),m=document.createElement("p"),u=document.createElement("p"),$=document.createTextNode(t.titre),R=document.createTextNode(t.descr),N=document.createTextNode(`${t.type}, ${t.width} x ${t.height}`);n.setAttribute("id","la_photo"),i.setAttribute("src",a+t.url.href),p.appendChild($),m.appendChild(R),u.appendChild(N),n.appendChild(i),n.appendChild(p),n.appendChild(m),n.appendChild(u),n.appendChild(c),n.appendChild(r),o.replaceChild(n,e)}function w(t){let o=document.getElementById("la_photo"),e=document.getElementById("la_categorie"),n=document.createTextNode(`categorie : ${t.nom}`);e.appendChild(n),o.appendChild(e)}function L(t){let o=document.getElementById("la_photo"),e=document.createElement("h4"),n=document.getElementById("les_commentaires"),r=document.createTextNode("Commentaires : ");e.appendChild(r),o.appendChild(e),t.forEach(c=>{let i=document.createElement("li"),p=document.createTextNode(`${c.pseudo} : ${c.content}`);i.appendChild(p),n.appendChild(i)}),o.appendChild(n)}var A=!1;async function d(t,o=""){if(A){let e=t(o);await e,e.then(n=>{B(n),document.querySelectorAll(".vignette").forEach(c=>{c.addEventListener("click",()=>T(c.firstChild.getAttribute("data-photoId")))})})}}var T=function(t){f(t).then(o=>{k(o.photo),P(o).then(e=>w(e.categorie)),U(o).then(e=>L(e.comments))})},P=function(t){return l(t.links.categorie.href)},U=function(t){return l(t.links.comments.href)};function j(){document.getElementById("load_gallery").addEventListener("click",()=>{A=!0,d(s,"/www/canals5/phox/api/photos")}),document.getElementById("previous_page").addEventListener("click",async()=>d(b)),document.getElementById("next_page").addEventListener("click",async()=>d(_)),document.getElementById("first_page").addEventListener("click",async()=>d(v)),document.getElementById("last_page").addEventListener("click",async()=>d(I))}window.addEventListener("DOMContentLoaded",j);})();
